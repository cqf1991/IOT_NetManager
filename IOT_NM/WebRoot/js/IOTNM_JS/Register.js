
var strJson={"IOT_DIR":{"NETS":[{"NET":[{"CVRG_LB_Y":["115.833313"],"SUBNET":[{"CVRG_LB_Y":["123."],"CVRG_LB_X":["123."],"CVRG_RU_Y":["100."],"CVRG_RU_X":["100."],"NODE":[{"SENSOR":[{"UNIT":["40"],"STPNM":["温度"],"SNSR_TP":["1"],"DSPTN":["1"]}],"TRSMTPWR":["123123"],"NDDSPT":["123"],"NDPHDR":["123"],"SENSORSIZE":["1"],"LCTN_X":["123."],"LCTN_Y":["123."]}],"NODESIZE":["1"],"NTNM":["1号"],"SBNTID":["1"],"DSPT":["123"]},{"CVRG_LB_Y":["10."],"CVRG_LB_X":["8."],"CVRG_RU_Y":["11."],"CVRG_RU_X":["11."],"NODE":[{"TRSMTPWR":["3"],"NDDSPT":["6"],"NDPHDR":["7"],"LCTN_X":["8."],"LCTN_Y":["9."]}],"NODESIZE":["1"],"NTNM":["3"],"SBNTID":["2"],"DSPT":["4"]}],"CVRG_LB_X":["28.6553593"],"CVRG_RU_Y":["1."],"NTDSCRPT":["1"],"CVRG_RU_X":["11."],"SUBNETSIZE":["2"],"NTID":["2"]},{"CVRG_LB_Y":["115.837997"],"CVRG_LB_X":["28.6580009"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["6"]},{"CVRG_LB_Y":["115.838997"],"CVRG_LB_X":["28.6590004"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["7"]},{"CVRG_LB_Y":["115.835541"],"SUBNET":[{"CVRG_LB_Y":["10."],"CVRG_LB_X":["8."],"CVRG_RU_Y":["11."],"CVRG_RU_X":["11."],"NTNM":["3"],"SBNTID":["2"],"DSPT":["4"]}],"CVRG_LB_X":["28.6561203"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"SUBNETSIZE":["1"],"NTID":["4"]},{"CVRG_LB_Y":["115.841003"],"CVRG_LB_X":["28.6609993"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["9"]},{"CVRG_LB_Y":["115.842003"],"CVRG_LB_X":["28.6620007"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["10"]},{"CVRG_LB_Y":["115.836998"],"CVRG_LB_X":["28.6569996"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["5"]},{"CVRG_LB_Y":["115.844002"],"CVRG_LB_X":["28.6639996"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["12"]},{"CVRG_LB_Y":["115.845001"],"CVRG_LB_X":["28.6650009"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["13"]},{"CVRG_LB_Y":["115.839996"],"SUBNET":[{"CVRG_LB_Y":["10."],"CVRG_LB_X":["8."],"CVRG_RU_Y":["11."],"CVRG_RU_X":["11."],"NODE":[{"TRSMTPWR":["3"],"NDDSPT":["6"],"NDPHDR":["7"],"LCTN_X":["8."],"LCTN_Y":["9."]}],"NODESIZE":["1"],"NTNM":["aaaa"],"SBNTID":["1"],"DSPT":["?°????è??é??"]}],"CVRG_LB_X":["28.7599998"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"SUBNETSIZE":["1"],"NTID":["8"]},{"CVRG_LB_Y":["115.847"],"CVRG_LB_X":["28.6669998"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["15"]},{"CVRG_LB_Y":["115.848"],"CVRG_LB_X":["28.6679993"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["16"]},{"CVRG_LB_Y":["115.843002"],"CVRG_LB_X":["28.6630001"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["11"]},{"CVRG_LB_Y":["115.849998"],"CVRG_LB_X":["28.6700001"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["18"]},{"CVRG_LB_Y":["115.850998"],"CVRG_LB_X":["28.6709995"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["19"]},{"CVRG_LB_Y":["115.846001"],"CVRG_LB_X":["28.6660004"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["1."],"NTID":["14"]},{"CVRG_LB_Y":["115.852997"],"CVRG_LB_X":["28.6730003"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["21"]},{"CVRG_LB_Y":["115.853996"],"CVRG_LB_X":["28.6739998"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["22"]},{"CVRG_LB_Y":["115.848999"],"CVRG_LB_X":["28.6690006"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["17"]},{"CVRG_LB_Y":["115.856003"],"CVRG_LB_X":["28.677"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["24"]},{"CVRG_LB_Y":["115.857002"],"CVRG_LB_X":["28.6779995"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["25"]},{"CVRG_LB_Y":["115.851997"],"CVRG_LB_X":["28.6720009"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["20"]},{"CVRG_LB_Y":["115.855003"],"CVRG_LB_X":["28.6749992"],"CVRG_RU_Y":["12."],"NTDSCRPT":["3"],"CVRG_RU_X":["11."],"NTID":["23"]}],"NETSIZE":["23"]}]}};
var Nets=strJson.IOT_DIR.NETS[0];
var net=new Array();
var subnet=new Array();
var node=new Array();
var sensor=new Array();

function ZhuCe()//注册功能
{

        
        var centerPanel = Ext.getCmp("centerPanel");  //Ext.ComponentManager.get方法的简写。 通过id查找现有的Component
            	if(Ext.getCmp("subscribeTab")==null)
            	{
         			
	            	centerPanel.add({	
	            	id:'subscribeTab',
					title:'注册',
					animCollapse:true,
					closable:true,
					
					 layout: 'fit',   	
					 listeners:{'beforeclose':function(){
	            		var w = Ext.getCmp('buttomGrid');
	            		if(w!=null)
		            	Ext.getCmp('buttomGrid').expand();
                      }} ,
	            	frame:true,
	            	 
                      items: [{
                    	  activeGroup: 1,
                    	  xtype: 'grouptabpanel',
                    	  //默认值为0，但0组因为bug问题被隐藏 
                    	  items: [{
                    		  
                    		  items:[{}  
                    		  ]}, 
                    	  {	
                expanded: false,
                items: {
                    mainItem:1,
                    title: '网络注册',
                    style: 'padding: 10px',
                    border: false,
                    autoScroll:true,
                    items:[{
                    	xtype:'form',
                    	id:'netReg',
                    	title:'网络注册',
                    	bodyPadding:10,
                    
                    	autoScroll:true,
                    	
                  		 fieldDefaults:{
                    	flex:1,
                    	
                    	labelWidth: 60,
                    },
                    	defaults:{
                    	expanded: false,
                    	allowBlank:false,	
                    	style:"margin-left:10px;margin-bottom:8px;"
                    },  
                    	items:[
                    	 {
                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',fieldLabel:'网络名称:',id:'NTID',anchor:'80%',name:'NTID'},{xtype:'textfield',id:'ssdw',anchor:'80%',fieldLabel:'所属单位:'}
                    	 ]},
                    	 {
                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',fieldLabel:'网络描述:',id:'NTDSCRPT',name:'wlms'},{xtype:'textfield',id:'dd',fieldLabel:'地点:'}
                    	 ]},
                    	 {
                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',fieldLabel:'维护单位:',name:'whdw',},{xtype:'textfield',id:'lxr',fieldLabel:'联系人:'}
                    	 ]},
                    	 {
                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',id:'lxdh',fieldLabel:'联系电话:'},{xtype:'textfield',id:'bz',fieldLabel:'备注:'}
                    	 ]},
                    	 {
                    		 xtype:'fieldset',title:'覆盖范围经纬度',anchor:'80%',items:[
                    	 {
                    		 xtype:'container',layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',id:'fgzsjd',fieldLabel:'覆盖范围左上点经度:',name:'NTID',},{xtype:'textfield',id:'fgzxjd',fieldLabel:'覆盖范围左下点经度:'}
                    	 ]},
                    	 {
                    		 xtype:'container', layout:'hbox',defaults:{padding:8},items:[
                    	{xtype:'textfield',id:'fgysjd',fieldLabel:'覆盖范围右上点经度:',name:'NTID',},{xtype:'textfield',id:'fgyxjd',fieldLabel:'覆盖范围右下点经度:'}
                    	 ]} 
                    	 ]}
                    	 
                    	],
                    	buttons:[{text:'提交',handler:function(){
                    		var form =Ext.getCmp('netReg').form;
                    		if(form.isValid()){
                    			form.submit({
                    				url:'regAction!netReg.action',	
                    				method:'post',
                    				params:{
                    				RegType:'net',
                    				
                    			},
                    				success:function(form,action){
                    				console.log(action);
                    			},
                    				failure:function(form,action){
                    				console.log(action);
                    				
                    				},
                    			});
                    			
                    		}
                    		
                    		}
                    	},
                    	         {text:'重置',handler:function(){Ext.getCmp('netReg').form.reset();}}]
                    }]       
                }
                },
            {           
                items: {
                    title: '子网注册',
                    style: 'padding: 10px',
                    border: false,
                    autoScroll:true,
                    items:[{
                    	xtype:'form',
                    	//layout:'hbox',
                    	id:'subnetReg',
                    	title:'子网注册',
                    	//defaultMargins: {top: 0, right: 5, bottom: 0, left: 0},
                    	bodyPadding:10,
                    	autoScroll:true,
                  		defaultType:'textfield',
                  	    fieldDefaults:{
                    	flex:1,
                    	labelWidth: 80,
                    },
                    	defaults:{
                    	expandeds: false,
                    	allowBlank:false,	
                    	style:"margin-left:10px;"
                    },       
                    	items:[
                          	 {
                        	 xtype:'container',layout:'hbox',anchor:'80%',defaults:{padding:8},items:[
                        	{
                        	xtype:'combobox',
                        	fieldLabel:'网络名称:',
                        	id:'NetOfSubReg',
                        	emptyText:'请选择网络',
                        	store:netStore(),
                        	},{xtype:'textfield',fieldLabel:'子网编号:'}
                        	 ]},
                        	 {
                        		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                        	{xtype:'textfield',fieldLabel:'子网名称:',name:'wlms'},{xtype:'textfield',fieldLabel:'子网描述:'}
                        	 ]},                        	 
                        	 {
                        		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                        	{xtype:'textfield',fieldLabel:'子网地址:',name:'lxdh',},{xtype:'textfield',fieldLabel:'工作信道:'}
                        	 ]},   
                        	 {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',items:[
                          	 {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',defaults:{padding:8},
                          		 items:[{xtype: 'textfield',fieldLabel:'工作周期'},{xtype:'displayfield',value:'(单位:秒)'}]
                         	  },
                         	  {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',defaults:{padding:8},items:[
                         	  {fieldLabel:'接入方式:',xtype:'combobox'},{xtype:'button',text:'添加',handler:NodeAdd,autoRender:true}]
                         	  },
                         	 ]},
                        	 {
                        		 xtype:'fieldset',title:'覆盖范围经纬度',anchor:'80%',items:[
                        	 {
                        		 xtype:'container',layout:'hbox',defaults:{padding:8},items:[
                        	{xtype:'textfield',fieldLabel:'覆盖范围左上点经度:',name:'NTID',},{xtype:'textfield',fieldLabel:'覆盖范围左下点经度:'}
                        	 ]},
                        	 {
                        		 xtype:'container', layout:'hbox',defaults:{padding:8},items:[
                        	{xtype:'textfield',fieldLabel:'覆盖范围右上点经度:',name:'NTID',},{xtype:'textfield',fieldLabel:'覆盖范围右下点经度:'}
                        	 ]} 
                        	 ]
                        	 }],
                    	buttons:[{text:'提交',autoRender:true},{text:'重置'}]
                    }]       
                }
                }
            ,{
                
                items: {
                title: '节点注册',    
                tabTip: 'Configuration tabtip',
                style: 'padding: 10px',
                border: false,
                autoScroll:true,

                items:[{
                	xtype:'form',
                	id:'nodeReg',
                	title:'节点注册',
                	bodyPadding:10,
                	autoScroll:true,
              		defaultType:'textfield',
              		fieldDefaults:{
                	flex:1,
                	labelWidth: 80,
                },
                	defaults:{
                	expanded: false,
                	allowBlank:false,	
                	style:"margin-left:10px;"
                },       
                	items:[
                        	 {
                            	 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                            	{xtype:'combobox',
                            	fieldLabel:'网络名称:',
                            	emptyText:'请选择网络',
                            	store:netStore(),
                            	valueField:net,
                            	displayField:netStore(),
                            	id:'subnetStore',
                            	name:'NTID',
                            	listeners:{'select':function(comboBox,rec){   		
                               	//	console.log(rec);
                            	}}
                            	},
                            	{
                             	xtype:'combobox',     	
                            	fieldLabel:'子网名称:',
                            	data:[],
                            	value:['ss'],         	
                             	}
                            	
                            	 ]},
                            	 {
                            		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                            	{xtype:'textfield',fieldLabel:'发射功率:',name:'wlms'},{xtype:'textfield',fieldLabel:'生产厂商:'}
                            	 ]},                

                            	 {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',items:[
                              	 {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',defaults:{padding:8},items:[{xtype: 'textfield',minWidth:'30',fieldLabel:'工作周期'},{xtype:'displayfield',value:'(单位:秒)'}]
                             	  },
                             	  {layout:'hbox',xtype:'fieldcontainer',anchor:'80%',defaults:{padding:8},items:[
                             	  {fieldLabel:'节点类型:',xtype:'combobox'},{xtype:'button',text:'添加',handler:NodeAdd,autoRender:true}]
                             	  },
                             	 ]},
                            	 {
                            		 xtype:'container',layout:'hbox',anchor:'80%',defaults:{padding:8},items:[
                            	{xtype:'textfield',fieldLabel:'节点描述信息:',name:'NTID',},{xtype:'textfield',fieldLabel:'节点物理地址:'}
                            	 ]},
                            	 {
                            		 xtype:'container',layout:'hbox',anchor:'80%',defaults:{padding:8},items:[
                            	{xtype:'textfield',fieldLabel:'节点位置经度:',name:'NTID',},{xtype:'textfield',fieldLabel:'节点位置纬度:'}
                            	 ]},
                            	 {
                            	 xtype:'container', layout:'hbox',anchor:'80%',defaults:{padding:8},items:[
                            	 {xtype:'textfield',fieldLabel:'规格型号和软件版本:',name:'NTID',}
                            	 ]},{xtype:'textarea',padding:10,fieldLabel:'备注:'} 
                            	 ],
                            	 buttons:[{text:'提交',padding:8,autoRender:true},{text:'重置'}]
                }]       
            }
                    },{
             
                items: {
                        title: '传感器注册',
                        
                        
                        tabTip: 'Configuration tabtip',
                        style: 'padding: 10px',
                        border: false,
                        autoScroll:true,
                       // overflowY:'auto',
                       // overflowX:'auto',
                    // html:"'*'为必填栏目",
                        items:[{
                        	xtype:'form',
                        	id:'sensorReg',
                        	title:'传感器注册',
                        	bodyPadding:10,
                        	autoScroll:true,
                      		defaultType:'textfield',
                      		 fieldDefaults:{
                        	flex:1,
                        	labelWidth: 100,
                        },
                        	defaults:{
                        	expanded: false,
                        	allowBlank:false,	
                        	style:"margin-left:10px;"
                        },       
                        	items:[
                        	    
                                 {
                                    	 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                                    	{xtype:'textfield',anchor:'80%',fieldLabel:'传感器名称:'},
                                    	{xtype:'combobox',
                                    	fieldLabel:'传感器类型:',
                                    	anchor:'80%',
                                    	store:sensorName,
                                    	value:'温度',
                                    	autoSelect:true,
                                    	mode:'local',
                                    	id:'sensorName',
                                    	name:'NTID'}
                                    	 ]},
                                    	 {
                                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                                    	{xtype:'textfield',fieldLabel:'传感器描述信息:',name:'wlms'},{xtype:'textfield',fieldLabel:'生产厂商:'}
                                    	 ]},                        	 
                                    	 {
                                    		 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                                    	{xtype:'textfield',fieldLabel:'转换公式参数列表:',name:'lxdh',},{xtype:'textfield',fieldLabel:'规格型号与版本:'}
                                    	 ]}, 
                                    	 {
                                    	 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                                    	{xtype:'textfield',fieldLabel:'计量单位:',name:'lxdh',},{xtype:'textfield',fieldLabel:'转换公式:'}]
                                    	},
                                    	{
                                       	 xtype:'container', anchor:'80%',layout:'hbox',defaults:{padding:8},items:[
                                       	{xtype:'textfield',fieldLabel:'精度:',name:'lxdh',},{xtype:'textfield',anchor:'20%',fieldLabel:'数据最大值:'}]
                                       	},
                                    	{
                                          xtype:'container', anchor:'20%',layout:'hbox',defaults:{padding:8},items:[
                                         {xtype:'textfield',fieldLabel:'数据最小值:',name:'lxdh',}]
                                        },
                             ],
                        	buttons:[{text:'提交',autoRender:true},{text:'重置'}]
                        }]       
                    }
                    }
            ]
        }]

	
	                })
	            	var w = Ext.getCmp('buttomGrid');
	            	w.collapse(); 
	            
	            	centerPanel.setActiveTab("subscribeTab");
	            	
	            	
            	}
            	
        }

function NodeAdd(){
	Ext.Msg.prompt("添加节点","请输入节点类型名称：",function (btn, text) {  
        if (btn =="ok") {  
          
        }   
	});
}
/*
 * 
 * 该区域提供comboBox的各种数据来源
 */

function netStore(){
	var subNet=new Array();
	for(var i in net)
	{
		subNet.push(net[i].NTID+"号网络");
	}
	return subNet;
}

var sensorName=new Ext.data.ArrayStore({
		fields:['text'],
		data:[['温度'],['湿度'],['各种度']],
})
sensorName.load();


	

